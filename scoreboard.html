<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QCMania 2 Scoreboard</title>
<style>
    body {
        margin: 0;
        background: transparent;
        font-family: 'Arial', sans-serif;
        color: white;
    }
    .scoreboard {
        display: flex;
        justify-content: space-around;
        align-items: center;
        height: 100vh;
        text-align: center;
    }
    .team {
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .team img {
        max-width: 300px;
        margin-bottom: 10px;
    }
    .score {
        font-size: 5em;
        font-weight: bold;
    }
</style>
</head>
<body>

<div class="scoreboard" id="scoreboard">
    <!-- Teams will be populated here -->
</div>

<script>
const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTp9jiAXHLSXP4d983ipXv0fKZheaaJLSt4OYWgLookJisCeWVuMwZhXKi7VFpkx-SsSVhNyyL95xO3/pub?gid=1637211824&single=true&output=csv';

const teamImages = {
    'Hogwarts': 'Images/Hogwarts.png',
    'Beauxbaton': 'Images/Beauxbaton.png',
    'Durmstrang': 'Images/Durmstrang.png',
    'Ilvermorny': 'Images/Ilvermorny.png'
};

async function fetchCSV() {
    const response = await fetch(csvUrl);
    const data = await response.text();
    return parseCSV(data);
}

function parseCSV(data) {
    const lines = data.split('\n');
    const headers = lines[0].split(',');
    const teams = [];

    for (let i = 1; i < lines.length; i++) {
        const row = lines[i].split(',');
        if (row.length < headers.length) continue;
        const team = {};
        headers.forEach((header, index) => {
            team[header.trim()] = row[index].trim();
        });
        teams.push(team);
    }
    return teams;
}

function renderScoreboard(teams) {
    const container = document.getElementById('scoreboard');
    container.innerHTML = '';

    teams.forEach(team => {
        const div = document.createElement('div');
        div.className = 'team';
        div.innerHTML = `
            <img src="${teamImages[team.Team]}" alt="${team.Team}">
            <div class="score">${team.Score}</div>
        `;
        container.appendChild(div);
    });
}

async function updateScoreboard() {
    const teams = await fetchCSV();
    // Sort by score descending
    teams.sort((a, b) => parseInt(b.Score) - parseInt(a.Score));
    renderScoreboard(teams);
}

// Update every 10 seconds
updateScoreboard();
setInterval(updateScoreboard, 10000);
</script>

</body>
</html>
